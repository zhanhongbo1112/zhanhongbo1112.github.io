<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="YuQi Knowledge Center">
  <meta name="author" content="Eric H B Zhan">

  <link rel="stylesheet" href="../../css/application.css">
</head>

<body class="dark">
<div class="container content-sm">
  <h2>Using FirewallD to Control Network Traffic</h2>

  <div class="headline">
    <h3>CentOS 7.x防火墙firewalld开放80端口</h3>
  </div>

  <div class="headline">
    <h4>开启80端口</h4>
  </div>

  <p><code>firewall-cmd --zone=public --add-port=80/tcp --permanent</code></p>

  <div class="headline">
    <h4>重启防火墙</h4>
  </div>

  <p><code>systemctl restart firewalld.service</code></p>

  <div class="headline">
    <h3>常用操作</h3>
  </div>

  <div class="headline">
    <h4>运行、停止、禁用firewalld</h4>
  </div>

  <p>启动：<code>systemctl start firewalld</code></p>

  <p>查看状态：<code>systemctl status firewalld</code> 或者 <code>firewall-cmd --state</code></p>

  <p>停止：<code>systemctl disable firewalld</code></p>

  <p>禁用：<code>systemctl stop firewalld</code></p>

  <div class="headline">
    <h4>配置firewalld</h4>
  </div>

  <p>查看版本：<code>firewall-cmd --version</code></p>

  <p>查看帮助：<code>firewall-cmd --help</code></p>

  <p>显示状态：<code>firewall-cmd --state</code></p>

  <p>查看区域信息: <code>firewall-cmd --get-active-zones</code></p>

  <p>查看指定接口所属区域：<code>firewall-cmd --get-zone-of-interface=eth0</code></p>

  <p>拒绝所有包：<code>firewall-cmd --panic-on</code></p>

  <p>取消拒绝状态：<code>firewall-cmd --panic-off</code></p>

  <p>查看是否拒绝：<code>firewall-cmd --query-panic</code></p>

  <div class="headline">
    <h4>更新防火墙规则</h4>
  </div>

  <p><code>firewall-cmd --reload</code></p>

  <p><code>firewall-cmd --complete-reload</code></p>

  <p>两者的区别就是第一个无需断开连接，就是firewalld特性之一动态添加规则，第二个需要断开连接，类似重启服务。</p>

  <p>将接口添加到区域：<code>firewall-cmd --zone=public --add-interface=eth0</code></p>

  <p>默认接口都在public，永久生效再加上 --permanent 然后reload防火墙。</p>

  <p>设置默认接口区域：<code>firewall-cmd --set-default-zone=public</code></p>

  <p>立即生效无需重启</p>

  <div class="headline">
    <h4>打开端口</h4>
  </div>

  <p>查看所有打开的端口：<code>firewall-cmd --zone=dmz --list-ports</code></p>

  <p>加入一个端口到区域：<code>firewall-cmd --zone=dmz --add-port=8080/tcp</code></p>

  <p>若要永久生效方法同上。</p>

  <div class="headline">
    <h4>打开一个服务</h4>
  </div>

  <p>类似于将端口可视化，服务需要在配置文件中添加，<code>/etc/firewalld</code> 目录下有<code>services</code>文件夹。</p>

  <p><code>firewall-cmd --zone=work --add-service=smtp</code></p>

  <div class="headline">
    <h4>移除服务</h4>
  </div>

  <p><code>firewall-cmd --zone=work --remove-service=smtp</code></p>
</div>
<script type="text/javascript" src="../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../js/jquery-migrate.min.js"></script>
<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../js/jquery.mCustomScrollbar.concat.min.js"></script>
</body>
</html>
